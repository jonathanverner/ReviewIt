{% extends "base.html" %}

{% block css %}
    {{ block.super }}
    <link rel="stylesheet" href="{{ STATIC_URL }}commentbin/css/pygments.css" />
    <link rel="stylesheet" href="{{ STATIC_URL }}commentbin/css/comments.css" />
{% endblock css %}

{% block javascript %}
    {{ block.super }}
    <script src="{{ STATIC_URL }}javascript/jquery.hotkeys.js"></script>
    <script src="{{ STATIC_URL }}commentbin/javascript/bootstrap-twipsy.js"></script>
    <script src="{{ STATIC_URL }}commentbin/javascript/bootstrap-modal.js"></script>
    <script src="{{ STATIC_URL }}commentbin/javascript/rangy-1.3alpha/rangy-core.js"></script>
    <script src="{{ STATIC_URL }}commentbin/javascript/rangy-1.3alpha/rangy-cssclassapplier.js"></script>
    <script src="{{ STATIC_URL }}commentbin/javascript/rangy-1.3alpha/rangy-textrange.js"></script>
    
    <script src="{{ STATIC_URL }}commentbin/javascript/comment.js"></script>
{% endblock javascript %}

{% block globalVars %}
  {% autoescape off %}

  {{ block.super }}

  initialServerComments = {{ comments }};  
  lastRetrieved = "{{ timestamp }}";

  {% endautoescape %}
{% endblock globalVars %}

{% block onReady %}

  {{ block.super }}
  
  commentInit();

{% endblock onReady %}





{% block title %} Snippet {{ snippet.title }} ({{ snippet.id }}) {% endblock %}

{% block content %}
<h1>{{ snippet.title }} ({{ snippet.id }})</h1>
<h2>{{ snippet.user_email }} </h2>
Created on {{ snippet.creation_date }}.
<div id='error'>
</div>

{% if main_comment %}
<div class='main_comment'>
<div class='author'>
<a href='mailto:{{ main_comment.email }}'>{{ main_comment.user_email }} </a>
</div>
{{ main_comment.text }}
</div>
{% endif %}

{% autoescape off %}
{{ snippet.formatted_html }}
{% endautoescape %}

{% if show_add_comment_form %}
<div id='add_comment_form' class='modal hide'>
<div class="modal-header">
    <button type="button" class="close" data-dismiss="modal">Ã—</button>
{% if user.is_authenticated %}
    <div style='float:right;margin:5px;'> <b>{{ user.username }} </b></div>
{% else %}
    <div style='float:right;margin:5px;'><input id='nick' onClick='this.value=""' type='textinput' value='Enter a nickname'/></div>
{% endif %}    
    <h3>Add a comment</h3>
</div>
  <div class="modal-body">
<form>
<textarea id='comment_field' name='comment'></textarea>
</form>
  </div>
  <div class='modal-footer'>
    <!--<a href="#" class="btn" data-dismiss="modal">Close</a>-->
    <a href="javascript:saveComment();" class="btn btn-primary">Comment</a>
  </div>
</div>
{% endif %}

{% if show
<div id='edit_comment_form' class='modal hide'>
<div class="modal-header">
{% if user.is_authenticated %}
    <div style='float:right;margin:5px;'> <b>{{ user.username }} </b></div>
{% else %}
    <div style='float:right;margin:5px;'><input id='nick' onClick='this.value=""' type='textinput' value='Enter a nickname'/></div>
{% endif %}
    <h3>Add a comment</h3>
</div>
  <div class="modal-body">
<form>
<textarea id='comment_edit_field' style='width:500px;height:200px;' name='comment'></textarea>
<input type='hidden' value='-1' id='commentid_edit_field' />
</form>
  </div>
  <div class='modal-footer'>
    <!--<a href="#" class="btn" data-dismiss="modal">Close</a>-->
    <a href="javascript:deleteComment();" class="btn">Delete Comment</a>
    <a href="javascript:editComment();" class="btn btn-primary">Save</a>
  </div>
</div>
{% endblock content %}